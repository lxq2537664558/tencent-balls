"use strict";function exists(e){try{return fs.accessSync(e),!0}catch(e){return!1}}function mkdir(e){if(0==exists(e)){e=e.replace(wx.env.USER_DATA_PATH,"");for(var n=e.split("/"),r="",i="";""==n[0];)n.shift();for(var t=0;t<n.length;t++)r=r+n[t]+"/",i=wx.env.USER_DATA_PATH+"/"+r,0==exists(i)&&fs.mkdirSync(i,!0)}}function rmdir(e,n){function r(e){fs.readdirSync(e).forEach(function(n){var o=e+"/"+n;fs.statSync(o).isDirectory()?(i.push(o),r(o)):t.push(o)})}if(0!=exists(e)){var i=[],t=[];r(e),i.reverse(),removeFile(t,function(){removeDir(i,function(){0!=n&&removeDir([e],null)})})}}function removeDir(e,n){if(e.length>0){var r=e.shift();fs.rmdir({dirPath:r,complete:function(){removeDir(e,n)}})}else null!=n&&n()}function removeFile(e,n){if(e.length>0){var r=e.shift();fs.unlink({filePath:r,complete:function(){removeFile(e,n)}})}else null!=n&&n()}function download(e,n,r,i){wx.downloadFile({url:e,success:function(e){try{var t=n.split("/");t.pop();mkdir(t.join("/")),fs.saveFile({tempFilePath:e.tempFilePath,filePath:n,success:function(e){null!=r&&r()},fail:function(e){null!=i&&i(new Error(e.errMsg))}})}catch(e){null!=i&&i(e)}},fail:function(){if(null!=i){var n=new RES.ResourceManagerError(1001,e);i(n)}}})}function openCache(e,n){var r=Date.now();download("https://cdn.kxtoo.com/balls/cache.txt?v="+r,wx.env.USER_DATA_PATH+"/"+cacheDir+"/cache.txt?v="+r,function(){require("./textCache.js"),console.info("Cache Init Cost: "+(Date.now()-r)+"ms"),null!=e&&e.call(n)},function(r){console.info("Cache Init Fail: "+r.message),null!=e&&e.call(n)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.exists=exists,exports.mkdir=mkdir,exports.rmdir=rmdir,exports.download=download,exports.openCache=openCache;var fs=wx.getFileSystemManager(),cacheDir=exports.cacheDir="cache_box";